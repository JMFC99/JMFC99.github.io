<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        background-color: black;
        color: white;
        font-family: 'Poppins', sans-serif;
      }

      table {
        border-collapse: collapse;
        width: 100%;
        border-radius: 10px;
        overflow: hidden;
      }

      th, td {
        border: 2px solid #EC008C;
        padding: 8px;
        text-align: left;
      }

      th {
        background-color: black;
        color: white;
      }

      td {
        color: white;
      }

      .logo-container {
        display: flex;
        justify-content: center;
        margin-bottom: 10px;
      }

      .logo {
        width: 416.3px;
        height: 234.1px;
      }

      .search-container {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }

      .search {
        flex-grow: 1;
        margin-right: 10px;
        background-color: black;
        border: 2px solid #92C83E;
        color: white;
        padding: 8px;
        font-size: 16px;
        border-radius: 999px;
        transition: border-color 0.3s;
      }

      .search:focus {
        outline: none;
        border-color: #92C83E;
      }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
      function filterData() {
        var input, filter, table, tr, td, i, j;
        input = document.getElementById("filterInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("dataTable");
        tr = table.getElementsByTagName("tr");

        if (filter !== '') {
          table.style.display = "table";
        } else {
          table.style.display = "none";
        }

        for (i = 1; i < tr.length; i++) {  // Comenzar desde 1 para omitir la fila de encabezado
          var found = false;
          td = tr[i].getElementsByTagName("td");
          for (j = 0; j < td.length; j++) {
            if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
              found = true;
              break;
            }
          }
          if (found) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }

      // Cargar la API de Google Sheets
      function loadSheetsApi() {
        gapi.client.load('sheets', 'v4', fetchData);
      }

      // Obtener los datos de la hoja de cálculo
      function fetchData() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1xFqUDNo2Wr89VyPOmwXNAECBnmrwnmWo_r-LOpLhvJ4',
          range: 'Respuestas de formulario 1!A:Z'
        }).then(function(response) {
          var values = response.result.values;
          var table = document.getElementById("dataTable");

          if (values && values.length > 0) {
            for (var i = 0; i < values.length; i++) {
              var row = values[i];
              var tr = document.createElement("tr");
              for (var j = 0; j < row.length; j++) {
                var td = document.createElement("td");
                td.textContent = row[j];
                tr.appendChild(td);
              }
              table.appendChild(tr);
            }
          } else {
            console.error('No se encontraron datos en la hoja de cálculo.');
          }
        }).catch(function(error) {
          console.error('Error en la solicitud fetch:', error);
        });
      }

      // Inicializar la API de Google Sheets
      function init() {
        gapi.client.init({
          apiKey: 'AIzaSyATXVYgAEC9dPaH8RydLbsuhpTsNFolg3w',
          discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4']
        }).then(function() {
          loadSheetsApi();
        }).catch(function(error) {
          console.error('Error al inicializar la API de Google Sheets:', error);
        });
      }

      // Cargar la API de cliente de Google
      gapi.load('client', init);
    </script>
  </head>
  <body>
    <div class="logo-container">
      <img class="logo" src="https://lh3.googleusercontent.com/pw/AIL4fc9VkVmnJYgEG4GXDTAmdk2A3OYNO66Cmq46fuLttJILSH8E2jLo8434HKMJ1U2c9FY0XzlNs8_XlyZalA6gH8v1_7ASFizrIjHk6BcqzAAJ8sAXPRiBhEWEU7Sxel7lZCjImcL7TQw_24QGJfJlOaE=w1228-h690-s-no" alt="Logo">
    </div>
    <div class="search-container">
      <input type="text" id="filterInput" placeholder="Búsqueda" class="search" onkeyup="filterData()">
    </div>
    <table id="dataTable" style="display: none;">
      <thead>
        <tr>
          <th style="background-color: black; color: white;">Marca temporal</th>
          <th style="background-color: black; color: white;">Nombre del mentee</th>
          <th style="background-color: black; color: white;">Tema visto</th>
          <th style="background-color: black; color: white;">Comentarios</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <script src="https://apis.google.com/js/client.js?onload=init"></script>
  </body>
</html>
